<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>WHYTEGOD Protocol</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body {
  font-family: Arial, sans-serif;
  background: #0b1020;
  color: #e6ebff;
  margin: 0;
  padding: 20px;
}
h1, h2 {
  color: #4da3ff;
}
.container {
  max-width: 820px;
  margin: auto;
}
.box {
  background: #111833;
  border-radius: 10px;
  padding: 20px;
  margin-bottom: 20px;
}
textarea {
  width: 100%;
  height: 80px;
  border-radius: 6px;
  border: none;
  padding: 10px;
  font-size: 16px;
}
button {
  background: #4da3ff;
  color: #000;
  border: none;
  padding: 12px 20px;
  border-radius: 6px;
  font-size: 16px;
  cursor: pointer;
  margin-top: 10px;
}
button.secondary {
  background: #1f2a55;
  color: #e6ebff;
}
.status {
  font-weight: bold;
  margin-top: 10px;
}
.code {
  background: #0b1020;
  padding: 10px;
  border-radius: 6px;
  font-family: monospace;
  font-size: 14px;
  word-break: break-all;
}
.peer {
  margin-top: 5px;
}
.notice {
  font-size: 14px;
  opacity: 0.9;
}
</style>
</head>

<body>
<div class="container">

<h1>WHYTEGOD Protocol</h1>
<p>Cryptographically enforced peer coordination for ordinary people.</p>

<div class="box">
<h2>Phase 13 — Anchor-Ready Protocol MVP</h2>
<p>This system transforms human intent into immutable cryptographic truth, verified by peers and anchored on Avalanche without tokens or smart contracts.</p>
</div>

<div class="box">
<h2>1️⃣ Proposal Creation</h2>
<textarea id="proposalInput" placeholder="Enter a proposal, agreement, or rule..."></textarea>
<button onclick="generateProposal()">Generate Proposal</button>
<div id="proposalStatus" class="status">Status: IDLE</div>
</div>

<div class="box">
<h2>2️⃣ Canonical Proposal Data</h2>
<div id="canonicalData" class="code">No proposal yet.</div>
</div>

<div class="box">
<h2>3️⃣ Cryptographic Commitment (SHA-256)</h2>
<div id="hashData" class="code">No hash yet.</div>
</div>

<div class="box">
<h2>4️⃣ Peer Verification</h2>
<div id="peer1" class="peer">Peer 1: ⏳ Pending</div>
<div id="peer2" class="peer">Peer 2: ⏳ Pending</div>
<div id="peer3" class="peer">Peer 3: ⏳ Pending</div>
</div>

<div class="box">
<h2>5️⃣ Finalization</h2>
<div id="finalStatus" class="status">Not finalized.</div>
</div>

<div class="box">
<h2>6️⃣ Avalanche Anchoring</h2>
<p class="notice">
Anchoring stores <b>only the hash</b> on Avalanche as a timestamp proof.
No proposal text, no execution, no smart contracts.
</p>

<div id="anchorHash" class="code">No finalized hash yet.</div>

<button class="secondary" onclick="copyHash()">Copy Hash</button>

<p class="notice">
After copying, send the hash as a transaction memo or data field on Avalanche C-Chain using your wallet (Core / MetaMask).
</p>

<p class="notice">
This creates a public, immutable timestamp proof.
</p>
</div>

</div>

<script>
let proposalObject = null;
let proposalHash = null;
let verifiedPeers = 0;
const THRESHOLD = 3;

async function generateProposal() {
  const text = document.getElementById("proposalInput").value.trim();
  if (!text) return;

  const timestamp = new Date().toISOString();
  const proposer = "anonymous-user";
  const ruleset = "WHYTEGOD-PROTOCOL-v1";

  proposalObject = {
    text: text,
    timestamp: timestamp,
    proposer: proposer,
    ruleset: ruleset
  };

  document.getElementById("proposalStatus").innerText = "Status: CREATED";

  const canonical = JSON.stringify(proposalObject);
  document.getElementById("canonicalData").innerText = canonical;

  proposalHash = await sha256(canonical);
  document.getElementById("hashData").innerText = proposalHash;

  simulatePeers();
}

async function sha256(message) {
  const msgBuffer = new TextEncoder().encode(message);
  const hashBuffer = await crypto.subtle.digest("SHA-256", msgBuffer);
  const hashArray = Array.from(new Uint8Array(hashBuffer));
  return hashArray.map(b => b.toString(16).padStart(2, "0")).join("");
}

function simulatePeers() {
  verifiedPeers = 0;
  resetPeers();
  setTimeout(() => verifyPeer("peer1"), 1000);
  setTimeout(() => verifyPeer("peer2"), 2000);
  setTimeout(() => verifyPeer("peer3"), 3000);
}

function resetPeers() {
  document.getElementById("peer1").innerText = "Peer 1: ⏳ Pending";
  document.getElementById("peer2").innerText = "Peer 2: ⏳ Pending";
  document.getElementById("peer3").innerText = "Peer 3: ⏳ Pending";
  document.getElementById("finalStatus").innerText = "Not finalized.";
  document.getElementById("anchorHash").innerText = "No finalized hash yet.";
}

function verifyPeer(peerId) {
  verifiedPeers++;
  document.getElementById(peerId).innerText =
    peerId.replace("peer", "Peer ") + ": ✅ Verified";

  if (verifiedPeers >= THRESHOLD) {
    document.getElementById("proposalStatus").innerText = "Status: FINALIZED";
    document.getElementById("finalStatus").innerText =
      "FINALIZED — Ready for Avalanche anchoring.";
    document.getElementById("anchorHash").innerText = proposalHash;
  }
}

function copyHash() {
  if (!proposalHash) return;
  navigator.clipboard.writeText(proposalHash);
  alert("Hash copied. Anchor it on Avalanche as a transaction memo or data field.");
}
</script>

</body>
</html>